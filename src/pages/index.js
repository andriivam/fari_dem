import Head from 'next/head';
import React from 'react';
import Header from '../../components/header/header';
import styles from '../styles/Home.module.css';
import ImageInput from '../../components/imageInput/image-input';
import ImageTextInput from '../../components/imageTextInput/image-text-input';
import TextInput from '../../components/textInput/textInput';



export default function Home() {



  const handleSubmit = async (e) => {
    const endPoint = "/api/predictions";
    const fakeEndPoint = "http://localhost:3010/v1/predictions";

    if (userInput === '' && globalInput === {}) {
      setSubmittedWithoutInputs(true);
      return
    }
    try {
      e.preventDefault();
      const response = await fetch(fakeEndPoint, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          version: version,
          input: globalInput
          //{ "prompt": null, "image": null, "input_image": null },
        }),
      });

      let prediction = await response.json();

      if (response.status !== 201) {
        setError(prediction.detail);
        console.log(error, 'error from frontend')
        return;
      }

      setPrediction(prediction);

      while (prediction.status !== "succeeded" && prediction.status !== "failed") {
        const response = await fetch("/api/predictions/" + prediction.id);
        prediction = await response.json();

        if (response.status !== 200) {
          setError(prediction.detail);
          return;
        }
        setPrediction(prediction);
      }



    } catch (error) {
      console.log({ error });
    }
  };

  return (
    <>
      <Head>
        <title>FARI</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Header />
      <div className={styles.container}>
        <div className={styles.headingInfo}>
          <h2 className={styles.header}>Step 1: choose an input</h2>
          <p className={styles.inputParagraph}> Choose what you want to submit. It will then be assimilated and modified by the algorithm.</p>
        </div>
        <div className={styles.cartsDiv}>
          <ImageInput />
          <ImageTextInput />
          <TextInput />
        </div>
      </div>
    </>
  )
}
